<!DOCTYPE html><html><head><meta charset='UTF-8'><meta name='viewport' content='initial-scale=1.0, maximum-scale=1.0, user-scalable=no'><style>
/**************************** CSS *************************************/



html,body {
    height: 100%;
    margin: 0px;
    padding: 0px;
}

#container {
    height: 100%;
    //border:solid red 1px;
    display:flex;
    flex-direction:column;
}

#out_container, #in_container {
    width: 100%;
    display:flex;
    flex-direction:row;
}



textarea {
    color:white;
    font-family: monospace;
    background-color:black;
    resize: none;
    overflow: auto;
    border-style: solid;
    border-width: 1px 0px 1px 0px;
    border-color: white;
    margin: 0px;
}

textarea:focus {
    outline:none;
}

#ruler {
    width: 4ch;
    overflow: hidden;
}

#out_container {
    flex-grow:3;
}

#in_container, #in, #out {
    flex-grow:1;
}



/**********************************************************************/
</style><script src='rsvp.min.js'></script><script>
/************************** JAVASCRIPT ********************************/



var require_script = function (the_script, scriptloadedcallback) {
    
    if (localStorage && localStorage.getItem('cached-' + the_script)) {
        
        var cs = localStorage.getItem('cached-' + the_script);
        var cs_tag = document.createElement("SCRIPT");
        cs_tag.id = the_script
        cs_tag.defer = true;
        cs_tag.text = cs;
        document.head.appendChild(cs_tag);
        if (scriptloadedcallback) {
            scriptloadedcallback();
        }
        
    } else {
        
        //alert("fetching..");
        
        var promise_script = function (the_script, callback) {
            var getScript = new RSVP.Promise(function (resolve, reject) {
                var xhr = new XMLHttpRequest();
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        resolve(xhr.responseText);
                    }
                }
                xhr.open("GET", the_script);
                xhr.send();
            });
            getScript.then(callback);
        }
        
        promise_script(the_script, function (fromResolve) {
            var cs_tag = document.createElement("SCRIPT");
            cs_tag.id = the_script
            cs_tag.defer = true;
            cs_tag.text = fromResolve;
            document.head.appendChild(cs_tag);
            if (scriptloadedcallback) {
                scriptloadedcallback();
            }
            localStorage.setItem('cached-' + the_script, fromResolve);
        });
        
    }

}



/**********************************************************************/
</script></head><body>
<!--************************* HTML **********************************-->



<div id='container'>
    <div id='out_container'><textarea id='out' readonly></textarea></div>
    <div id='in_container'>
        <textarea id='ruler' readonly>>>> 
</textarea>
        <textarea id='in' autofocus></textarea>
    </div>
</div>




<!--*****************************************************************-->
<div id='buffer'></div><script id='rs_code' type='text/python'>
#************************** RAPYDSCRIPT *******************************/



RapydScript_version = document.querySelectorAll('script[id^="rapydscript"]')[0].id.replace(/^rapydscript-|\.js$/g, "")
#RapydScript_version = '0.5.53'




class ՐՏ_HelperFunctions:

    def __init__(self, repl):
        self.repl = repl
        self.code_area = [self.repl.code_in, self.repl.code_out, self.repl.ruler]
        document.body.style.height = '100%'
        for i in self.code_area:
            i.style.fontSize = '10pt'
        window.intro = self.intro.bind(self)
        window.help = self.help.bind(self)
        window.ՐՏ_print = self.print.bind(self)
        window.cls = self.cls.bind(self)
        window.ih = self.ih.bind(self)
        window.dh = self.dh.bind(self)
        window.ifz = self.ifz.bind(self)
        window.dfz = self.dfz.bind(self)
        window.tc = self.tc.bind(self)
        window.bc = self.bc.bind(self)
        window.js_out = self.js_out.bind(self)


    def intro(self):
        self.repl.code_out.value = "RapydScript " + RapydScript_version + " REPL, " + (new Date).toString() + "\n" +\
        "[" + window.navigator.userAgent + "] " + "\n" +\
        "Type \"help()\" for more information.\n"


    def help(self):
        self.repl.code_out.value = self.repl.code_out.value + "Type \"ih(n)\" or \"dh(n)\" to increase or decrease body height, where n is a number representing amount of percent. Default to 5.\n" +\
        "Type \"ifz(n)\" or \"dfz(n)\" to increase or decrease font size, where n is a number representing amount of pt. Default to 1.\n" +\
        "Type \"tc(c)\" to change text color, where c is a string representing CSS color. Default to 'white'\n" +\
        "Type \"bc(c)\" to change background color, where c is a string representing CSS color. Default to 'black'\n" +\
        "Type \"cls()\" to clear screen.\n" +\
        "Type \"intro()\" to clear screen and print the intro.\n" +\
        "Type \"print(js_out(-1))\" to see the js output of the last rapydscript code entered.\n" +\
        "Type \"help()\" to print this message.\n"


    def print(self, t):
        self.repl.code_out.value = self.repl.code_out.value + t.toString() + '\n'


    def cls(self):
        self.repl.code_out.value = ''
        self.repl.code_in.value = ''
        self.repl.setRuler()


    def dh(self, n=5):
        document.body.style.height = (parseInt(document.body.style.height) - n).toString() + '%'


    def ih(self, n=5):
        document.body.style.height = (parseInt(document.body.style.height) + n).toString() + '%'


    def ifz(self, n=1):
        for i in self.code_area:
            i.style.fontSize = (parseInt(i.style.fontSize) + n).toString() + 'pt'


    def dfz(self, n=1):
        for i in self.code_area:
            i.style.fontSize = (parseInt(i.style.fontSize) - n).toString() + 'pt'


    def tc(self, c='white'):
        for i in self.code_area:
            i.style.color = c


    def bc(self, c='black'):
        for i in self.code_area:
            i.style.backgroundColor = c


    def js_out(self, c=-1):
        if type(c) == 'Number':
            if c < 0:
                rs = repl.buffer_list[repl.buffer_list.length + (c - 1)]
            else:
                rs = repl.buffer_list[c]
        elif type(c) == 'String':
            rs = c
        jso = rapydscript.compile(rs, {omit_baselib: true, private_scope: false, beautify: true}).replace('\nvar __name__ = "__main__";\n','')
        return jso




class ՐՏ_Repl:

    def __init__(self):
        self.code_in = document.getElementById('in')
        self.ruler = document.getElementById('ruler')
        self.code_out = document.getElementById('out')
        self.buffer = document.getElementById('buffer')
        

    def initialize(self):
        self.buffer_list = []
        self.buffer_pointer = 0
        self.code_in.onkeydown = def(ev):
            if ev.which == 13:
                self.onEnterCallback.bind(self)(ev)
            elif ev.which == 8:
                self.onBackspaceCallback.bind(self)(ev)
            elif ev.which == 46:
                self.onDeleteCallback.bind(self)(ev)
            elif ev.which == 38:
                self.onUpArrowCallback.bind(self)(ev)
            elif ev.which == 40:
                self.onDownArrowCallback.bind(self)(ev)

        self.code_in.onscroll = def(ev):
            self.ruler.scrollTop = ev.target.scrollTop

        intro()
        self.code_out.value = self.code_out.value + '>>> '

        ՐՏ_HelperFunctions(self)


    def onEnterCallback(self, ev):
        if self.code_in.value[-1] == '\n':
            ev.preventDefault()
            self.exec.bind(self)()
        else:
            self.ruler.value = self.ruler.value + "... \n"


    def describe_array(self, arr):
        res = '['
        for i in arr:
            if Object.prototype.toString.call(i) == '[object Number]':
                res = res + ', ' + i
            else if Object.prototype.toString.call(i) == '[object String]':
                res = res + ', \'' + i + '\'' 
            else if Object.prototype.toString.call(i) == '[object Boolean]':
                res = res + ', ' + i
            else:
                res = res + ', ' + Object.prototype.toString.call(i)
        return res.replace(/^\[\, /g, '[') + ']'

    
    def exec(self):
        code_in_text = self.code_in.value
        self.buffer_list.push(code_in_text)
        self.buffer_pointer = self.buffer_list.length + 0
        self.code_out.value = self.code_out.value[0:-4] + self.fusion.bind(self)(self.ruler.value, self.code_in.value) + '\n'
        self.ruler.value = '>>> \n'
        self.code_in.value = ''

        try:

            code_out_text = rapydscript.compile(code_in_text, {omit_baselib: true, private_scope: false, beautify: true}).replace("var __name__ = \"__main__\";\n","")
            out_retval = (def (inp):
                out_eval = eval.call(window, inp)
                if Object.prototype.toString.call(out_eval) == '[object Number]':
                    return out_eval
                else if Object.prototype.toString.call(out_eval) == '[object String]':
                    return out_eval
                else if Object.prototype.toString.call(out_eval) == '[object Boolean]':
                    return out_eval
                else if Object.prototype.toString.call(out_eval) == '[object Date]':
                    return out_eval
                else if Object.prototype.toString.call(out_eval) == '[object RegExp]':
                    return out_eval
                else if Object.prototype.toString.call(out_eval) == '[object Array]':
                    return self.describe_array.bind(self)(out_eval)
                else if Object.prototype.toString.call(out_eval) == '[object Undefined]':
                    return ''
                else:
                    return Object.prototype.toString.call(out_eval)
            ).call(window, code_out_text.replace(/^\n|;$/g, ""))
        
            if out_retval == '':
                pass
            else:
                print(out_retval)

        except as err:
            self.code_out.value = self.code_out.value + err.name + ': ' + err.message + '\n'

        self.code_out.value = self.code_out.value + '>>> '


    def fusion(self, left, right):
        leftl = left.split('\n')
        rightl = right.split('\n')
        outputl = []
        for i in range(len(rightl)-1):
            outputl.push(leftl[i] + rightl[i])
        return outputl.join('\n')


    def onBackspaceCallback(self, ev):
        self.setRuler()


    def onDeleteCallback(self, ev):
        self.setRuler()


    def setRuler(self):
        line_count = self.getNewLinePosition().length
        ruler_text = ">>> \n"
        for i in range(line_count - 1):
            ruler_text = ruler_text + '... \n'
        self.ruler.value = ruler_text


    def getNewLinePosition(self):
        br_line = self.code_in.value.split('\n')
        list_nl = []
        for i in br_line:
            if list_nl.length == 0:
                list_nl.push(i.length)
            else:
                list_nl.push(list_nl[-1] + 1 + i.length)
        if list_nl.length == 0:
            return [0]
        else:
            return list_nl


    def onUpArrowCallback(self, ev):
        if ev.target.selectionStart <= self.getNewLinePosition()[0]:
            ev.preventDefault()
            if self.buffer_pointer == 0:
                if self.buffer_list.length == 0:
                    pass
                else:
                    self.code_in.value = self.buffer_list[self.buffer_pointer]
                    setTimeout(self.moveTo0,0)
            else:
                self.buffer_pointer = self.buffer_pointer - 1
                self.code_in.value = self.buffer_list[self.buffer_pointer]
                setTimeout(self.moveTo0,0)


    def moveTo0(self):
        self.code_in.selectionStart = 0
        self.code_in.selectionEnd = 0
        self.setRuler()


    def onDownArrowCallback(self, ev):
        nl_poss = self.getNewLinePosition()
        if nl_poss.length < 2 or ev.target.selectionStart > nl_poss[-2]:
            ev.preventDefault()
            if self.buffer_list.length == 0 or self.buffer_pointer == self.buffer_list.length:
                self.code_in.value = ""
                self.setRuler()
            else:
                self.buffer_pointer = self.buffer_pointer + 1
                if self.buffer_pointer == self.buffer_list.length:
                    self.code_in.value = ""
                    self.setRuler()
                else:
                    self.code_in.value = self.buffer_list[self.buffer_pointer]
                    setTimeout(moveTo0,0)




ՐՏ_Repl().initialize()




#**********************************************************************/
</script><script id='rs_out'></script><script>
    
    var compile_rs_code = function() { document.getElementById('rs_out').innerHTML = rapydscript.compile(document.getElementById('rs_code').innerHTML, {private_scope: false, beautify: true}); }
    require_script('rapydscript-0.5.53.js', compile_rs_code);
    //compile_rs_code();

</script></body></html>